################################################################
#  Makefile for the SWI-Prolog DLL demos
################################################################

srcdir=@srcdir@
@VPATH@ @srcdir@

CC=@CC@
LDEXE=@LDEXE@
PLARCH=@PLARCH@
SOEXT=@SO_EXT@

COFLAGS=@COFLAGS@
CWFLAGS=@CWFLAGS@
CIFLAGS=@CIFLAGS@ -I$(PLHOME)/src
CMFLAGS=@CMFLAGS@
CPFLAGS=
CFLAGS=	$(CWFLAGS) $(COFLAGS) $(CIFLAGS) $(CMFLAGS) $(CPFLAGS)
LDFLAGS=@LDFLAGS@ $(CPFLAGS)

PLHOME=../../..

include $(srcdir)/../../common.mk

PLREGTRY=	$(PLHOME)/lib/$(PLARCH)/plregtry.$(SOEXT)
DLLTEST=	$(PLHOME)/lib/$(PLARCH)/dlltest.$(SOEXT)

all:	$(PLREGTRY) $(DLLTEST)

$(PLREGTRY):	plregtry.o
	$(CC) -shared $(COFLAGS) -o $@ $^ -L$(PLHOME)/lib/$(PLARCH) -lswipl

$(DLLTEST):	dlltest.o
	$(CC) -shared $(COFLAGS) -o $@ $^ -L$(PLHOME)/lib/$(PLARCH) -lswipl -lplterm

clean:
	rm -f *.o
	rm -f *~

distclean: clean
	rm -f $(PLHOME)/lib/$(PLARCH)/plregtry.$(SOEXT)
	rm -f $(PLHOME)/lib/$(PLARCH)/plregtry.$(SOEXT).a
	rm -f $(PLHOME)/lib/$(PLARCH)/dlltest.$(SOEXT)
	rm -f $(PLHOME)/lib/$(PLARCH)/dlltest.$(SOEXT).a
